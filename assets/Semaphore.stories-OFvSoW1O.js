var g=Object.defineProperty;var q=(s,e,o)=>e in s?g(s,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[e]=o;var n=(s,e,o)=>q(s,typeof e!="symbol"?e+"":e,o);import{j as r}from"./jsx-runtime-CLpGMVip.js";import{r as a}from"./index-CZMpeKRu.js";import{B as c}from"./Button-_4CykwWA.js";import"./Tag-C6O_w9z4.js";import"./FloatingLabelInput-BA7Awa4f.js";import"./Pager-CULFxKHR.js";import"./Select-Bo_mqxqZ.js";import"./Table-CASTOlGJ.js";class C{constructor(e){n(this,"permits");n(this,"maxPermits");n(this,"queue");this.permits=e,this.maxPermits=e,this.queue=[]}async acquire(){return this.permits>0?(this.permits--,this.release.bind(this)):await new Promise(e=>{this.queue.push(()=>{e(this.release.bind(this))})})}release(){if(this.queue.length>0){const e=this.queue.shift();e==null||e()}else this.permits<this.maxPermits&&this.permits++}}const u=new C(3),S=()=>{const[s,e]=a.useState(0),[o,m]=a.useState(0),[x,p]=a.useState(0),f=async()=>{p(t=>t+1),e(t=>t+1),await u.acquire(),e(t=>t-1),m(t=>t+1)},j=()=>{x>0&&(u.release(),m(t=>t-1),p(t=>t-1))};return r.jsxs("div",{children:[r.jsx("h1",{children:"Semaphore Demo"}),r.jsxs("p",{children:["当前正在处理的请求数量: ",o]}),r.jsxs("p",{children:["等待队列长度: ",s]}),r.jsx(c,{onClick:()=>f(),children:"获取信号量"}),r.jsx(c,{type:"cancel",onClick:()=>j(),children:"释放信号量"})]})};S.__docgenInfo={description:"",methods:[],displayName:"SemaphoreComponent"};const _={title:"UTILS/Semaphore"},b=()=>r.jsx(S,{}),i=b.bind({});var h,l,d;i.parameters={...i.parameters,docs:{...(h=i.parameters)==null?void 0:h.docs,source:{originalSource:"() => <SemaphoreComponent />",...(d=(l=i.parameters)==null?void 0:l.docs)==null?void 0:d.source}}};const y=["Example"],I=Object.freeze(Object.defineProperty({__proto__:null,Example:i,__namedExportsOrder:y,default:_},Symbol.toStringTag,{value:"Module"}));export{I as S};
