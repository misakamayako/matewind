var g=Object.defineProperty;var q=(s,e,r)=>e in s?g(s,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[e]=r;var i=(s,e,r)=>q(s,typeof e!="symbol"?e+"":e,r);import{j as o}from"./jsx-runtime-CLpGMVip.js";import{r as a}from"./index-CZMpeKRu.js";import{B as u}from"./Button-BWSya2Zu.js";import"./FormItem-BrhqolgX.js";import"./FloatingLabelInput-DFFEPAC1.js";import"./Modal-CS3pVmoZ.js";import"./Pager-Ddx2DgsT.js";import"./Select-CwxL0ltO.js";import"./Table-CASTOlGJ.js";class C{constructor(e){i(this,"permits");i(this,"queue");this.permits=e,this.queue=[]}async acquire(){if(this.permits>0){this.permits--;return}await new Promise(e=>this.queue.push(e))}release(){if(this.queue.length>0){const e=this.queue.shift();e==null||e()}else this.permits++}}const h=new C(3),p=()=>{const[s,e]=a.useState(0),[r,c]=a.useState(0),[x,m]=a.useState(0),f=async()=>{m(t=>t+1),e(t=>t+1),await h.acquire(),e(t=>t-1),c(t=>t+1)},j=()=>{x>0&&(h.release(),c(t=>t-1),m(t=>t-1))};return o.jsxs("div",{children:[o.jsx("h1",{children:"Semaphore Demo"}),o.jsxs("p",{children:["当前正在处理的请求数量: ",r]}),o.jsxs("p",{children:["等待队列长度: ",s]}),o.jsx(u,{onClick:()=>f(),children:"获取信号量"}),o.jsx(u,{type:"cancel",onClick:()=>j(),children:"释放信号量"})]})};p.__docgenInfo={description:"",methods:[],displayName:"SemaphoreComponent"};const _={title:"UTILS/Semaphore",component:p},y=()=>o.jsx(p,{}),n=y.bind({});var l,d,S;n.parameters={...n.parameters,docs:{...(l=n.parameters)==null?void 0:l.docs,source:{originalSource:"() => <SemaphoreComponent />",...(S=(d=n.parameters)==null?void 0:d.docs)==null?void 0:S.source}}};const E=["Example"],z=Object.freeze(Object.defineProperty({__proto__:null,Example:n,__namedExportsOrder:E,default:_},Symbol.toStringTag,{value:"Module"}));export{z as S};
