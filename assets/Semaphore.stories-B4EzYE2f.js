var j=Object.defineProperty;var q=(s,e,o)=>e in s?j(s,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[e]=o;var a=(s,e,o)=>q(s,typeof e!="symbol"?e+"":e,o);import{j as r}from"./jsx-runtime-D_zvdyIk.js";import{r as n}from"./index-2yJIXLcc.js";import{B as p}from"./Button-BMswa-Cn.js";import"./Tag-CyvJyZIy.js";import"./FloatingLabelInput-esnStef_.js";import"./Pager-CuikBxut.js";import"./Table-CnUlTgBP.js";import"./Option-D-_hemD3.js";class g{constructor(e){a(this,"permits");a(this,"maxPermits");a(this,"queue");this.permits=e,this.maxPermits=e,this.queue=[]}async acquire(){return this.permits>0?(this.permits--,this.release.bind(this)):await new Promise(e=>{this.queue.push(()=>{e(this.release.bind(this))})})}release(){if(this.queue.length>0){const e=this.queue.shift();e==null||e()}else this.permits<this.maxPermits&&this.permits++}}const u=new g(3),C=()=>{const[s,e]=n.useState(0),[o,m]=n.useState(0),[S,c]=n.useState(0),x=async()=>{c(t=>t+1),e(t=>t+1),await u.acquire(),e(t=>t-1),m(t=>t+1)},f=()=>{S>0&&(u.release(),m(t=>t-1),c(t=>t-1))};return r.jsxs("div",{children:[r.jsx("h1",{children:"Semaphore Demo"}),r.jsxs("p",{children:["当前正在处理的请求数量: ",o]}),r.jsxs("p",{children:["等待队列长度: ",s]}),r.jsx(p,{onClick:()=>x(),children:"获取信号量"}),r.jsx(p,{type:"cancel",onClick:()=>f(),children:"释放信号量"})]})},_={title:"UTILS/Semaphore"},b=()=>r.jsx(C,{}),i=b.bind({});var h,l,d;i.parameters={...i.parameters,docs:{...(h=i.parameters)==null?void 0:h.docs,source:{originalSource:"() => <SemaphoreComponent />",...(d=(l=i.parameters)==null?void 0:l.docs)==null?void 0:d.source}}};const y=["Example"],z=Object.freeze(Object.defineProperty({__proto__:null,Example:i,__namedExportsOrder:y,default:_},Symbol.toStringTag,{value:"Module"}));export{z as S};
